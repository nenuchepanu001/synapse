use nyc_taxi_ldw
GO

DROP VIEW IF EXISTS bronze.vw_rate_code
GO

CREATE VIEW bronze.vw_rate_code
AS
SELECT rate_code_id,rate_code
    FROM OPENROWSET(
        BULK 'raw/rate_code.json',
        DATA_SOURCE = 'nyc_taxi_src',
        FORMAT='CSV',
        FIELDTERMINATOR='0x0b',
        FIELDQUOTE='0x0b',
        ROWTERMINATOR='0x0b'
    ) WITH(
        jsonDoc NVARCHAR(MAX)
    )AS rate_code
    CROSS APPLY OPENJSON(jsonDoc)
    WITH
    (
        rate_code_id TINYINT,
        rate_code VARCHAR(20)
    )
    GO

    SELECT * FROM bronze.vw_rate_code
    GO

----- payment type
DROP VIEW IF EXISTS bronze.vw_payment_type
GO

CREATE VIEW bronze.vw_payment_type
AS
SELECT payment_type,description
    FROM OPENROWSET(
        BULK 'raw/payment_type.json',
        DATA_SOURCE = 'nyc_taxi_src',
        FORMAT='CSV',
        FIELDTERMINATOR='0x0b',
        FIELDQUOTE='0x0b'
    ) WITH(
        jsonDoc NVARCHAR(MAX)
    )AS payment_type
    CROSS APPLY OPENJSON(jsonDoc)
    WITH(
        payment_type SMALLINT,
        description VARCHAR(20) '$.payment_type_desc'
    );

    SELECT * FROM bronze.vw_payment_type
    GO



